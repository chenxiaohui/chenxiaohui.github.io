<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Linux | CXH.ME]]></title>
  <link href="http://cxh.me/category/linux/atom.xml" rel="self"/>
  <link href="http://cxh.me/"/>
  <updated>2015-07-15T22:45:38+08:00</updated>
  <id>http://cxh.me/</id>
  <author>
    <name><![CDATA[Harry Chen]]></name>
    <email><![CDATA[sdqxcxh@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Git远程分支不存在的问题]]></title>
    <link href="http://cxh.me/2015/05/11/git-remote-branch-not-exists/"/>
    <updated>2015-05-11T12:11:00+08:00</updated>
    <id>http://cxh.me/2015/05/11/git-remote-branch-not-exists</id>
    <content type="html"><![CDATA[<p>  建立了一个远程分支，提交到origin上之后，发现之前有一个同样的远程Repository存在，而且名字一样，这就比较D疼了，git branch -a 显示的分支里面的分支提交到了另一个Repository，但是这个Repository已经改名字了，虽然地址一样。</p>

<p>  搞来搞去之后发现git checkout远程分支的时候报不存在的问题，删除这个分支的时候同样有这个问题：</p>

<pre><code>unable to delete 'refactor': remote ref does not exist
</code></pre>

<p>  导致这个分支就这么存在着删不掉了。查stackoverflow有人给出<a href="http://stackoverflow.com/questions/10292480/when-deleting-remote-git-branch-error-unable-to-push-to-unqualified-destinatio" title="When deleting remote git branch “error: unable to push to unqualified destination”">如下的方案</a>：</p>

<pre><code>git fetch -p origin
</code></pre>

<p>  问题是能解决了，但是不太理解为什么。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于sendmail邮件服务器的搭建]]></title>
    <link href="http://cxh.me/2015/04/01/something-about-sendmail-setup/"/>
    <updated>2015-04-01T20:14:00+08:00</updated>
    <id>http://cxh.me/2015/04/01/something-about-sendmail-setup</id>
    <content type="html"><![CDATA[<p>  还是reviewboard的事情，我们需要一个自己的邮件服务器来发通知邮件。sendmail是一个比较好的选择，搭建的方式很简单，安装sendmail，修改配置文件，修改local_host_name就行。如果不需要登陆验证，这样也就直接能用了。现在的问题是reviewboard是必须登陆验证的。至少看报错上是这样。</p>

<pre><code>SMTPException: SMTP AUTH extension not supported by server. reviewboard
</code></pre>

<p>  具体代码没细看，但是应该默认都有认证，只是认证方式不一样。我们telnet到25端口，执行</p>

<pre><code>ehlo localhost
</code></pre>

<p>  发现250 AUTH没有支持。所以需要配置邮件服务器的身份认证。详见<a href="http://blog.sina.com.cn/s/blog_6b61ec070101e161.html" title="CentOS sendmail安装及邮件域名配置">参考文献1</a><a href="http://ju.outofmemory.cn/entry/12533" title="testsaslauthd “authentication failed” 解决办法">参考文献2</a>。最后测试一下用户是否能通过验证和邮件能否正常发送：</p>

<pre><code>/usr/sbin/testsaslauthd -u username -p sohutest

mail -s "test" xxx@xxx.com &lt;content.txt
</code></pre>

<!--more-->


<p>  如果邮件不能正常发送可以通过如下方式debug：</p>

<pre><code>1. 查看/var/log/messages
2. 查看用户mail
3. 通过telnet模拟一下登陆发邮件的过程：

        HELO localhost
        AUTH LOGIN 
        aGFycnljaGVu
        c29odXRlc3Q=
        MAIL FROM:&lt;test@xxx.com&gt;
        RCPT TO:&lt;username@xxx.com&gt;
        DATA
        To: username@xxx.com
        From:test@xxx.com
        Subject:test mail
        From:test@xxx.com
        test body
        .
        quit
</code></pre>

<p>  安装reviewboard的过程还发现一个问题，邮件服务器已经可以正常发邮件了，reviewboard还是失败，看到如下报错：</p>

<pre><code>- Error sending e-mail notification with subject 'Review Request 2: [retrieval-ad][master][NewFeature] Readme' on behalf of '"UserName" &lt;xxx@xxx.com&gt;' to '"UserName" &lt;xxx@xxx.com&gt;,xxx@xxx.com'
Traceback (most recent call last):
  File "/opt/xxx/rb/lib/python2.7/site-packages/ReviewBoard-2.0.15-py2.7.egg/reviewboard/notifications/email.py", line 294, in send_review_mail
    message.send()
  File "/opt/xxx/rb/lib/python2.7/site-packages/Django-1.6.11-py2.7.egg/django/core/mail/message.py", line 276, in send
    return self.get_connection(fail_silently).send_messages([self])
  File "/opt/xxx/rb/lib/python2.7/site-packages/Django-1.6.11-py2.7.egg/django/core/mail/backends/smtp.py", line 87, in send_messages
    new_conn_created = self.open()
  File "/opt/xxx/rb/lib/python2.7/site-packages/Django-1.6.11-py2.7.egg/django/core/mail/backends/smtp.py", line 54, in open
    self.connection.login(self.username, self.password)
  File "/usr/local/lib/python2.7/smtplib.py", line 613, in login
    raise SMTPAuthenticationError(code, resp)
SMTPAuthenticationError: (535, '5.7.0 authentication failed')
</code></pre>

<p>  跟到如下smtplib.py里面看验证方法，调整了顺序（我这支持AUTH LOGIN PLAIN，没支持PAM)，然后保证用户名密码正确就基本可以使用了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ps grep不显示grep自己本身的方法]]></title>
    <link href="http://cxh.me/2015/03/31/ps-do-not-grep-self/"/>
    <updated>2015-03-31T15:45:00+08:00</updated>
    <id>http://cxh.me/2015/03/31/ps-do-not-grep-self</id>
    <content type="html"><![CDATA[<p>  主要两种方式：</p>

<ol>
<li><p>不grep自己。</p>

<pre><code> -v, --invert-match
     Invert the sense of matching, to select non-matching lines.
 所以：
     ps xuf|grep python|grep -v grep
</code></pre></li>
<li><p>awk 略去最后一行。</p>

<pre><code> ps xuf|grep python|awk 'NR&gt;1{print p}{p=$2}'
</code></pre>

<p> 解释下：第一行的时候，NR=1不打印，但是把pid存在p中，下一行打印，最后一行的时候，打印的是上一行的pid。</p>

<p> awk博大精深&hellip;</p></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于ubuntu gnome下crontab运行的问题]]></title>
    <link href="http://cxh.me/2015/03/24/ubuntu-gnome-crontab/"/>
    <updated>2015-03-24T13:54:00+08:00</updated>
    <id>http://cxh.me/2015/03/24/ubuntu-gnome-crontab</id>
    <content type="html"><![CDATA[<p>  今天想在gnome下运行一个自动关机前的提示，发现crontab根本不起作用啊。以为是路径和root权限的问题，但是路径没问题，而且root的crontab必须要sudo crontab -e的，也就是说crontab还是执行在当前用户下。</p>

<p>  后来发现对图形界面程序来讲，crontab的进程需要指定输出到哪个显示的，也就是</p>

<pre><code>export DISPLAY=:0 #:0指第一个显示终端，ctrl+alt+f7那个
/usr/bin/notify-send "亲，该去运动了！！一分钟后关机，请保存所有未保存的Job."
sudo shutdown -h 1
</code></pre>

<p>  或者直接在crontab -e中指定环境变量：</p>

<pre><code>DISPLAY=:0
30 20 * * * /home/cxh/repo/scripts/shutdown.sh
</code></pre>

<p>  可以顺便制定一下其他变量</p>

<pre><code>SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=cxh #如果出现错误，或者有数据输出，数据作为邮件发给这个帐号
HOME=/home/cxh #使用者运行的路径,这里是根目录
</code></pre>

<p>  crontab出错的信息会发邮件到对应用户，mail或者cat /var/mail/$USER查看。d *清理。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于Linux 安装和卸载tar ball形式的程序]]></title>
    <link href="http://cxh.me/2015/03/16/linux-install-uninstall-tar-ball/"/>
    <updated>2015-03-16T12:11:00+08:00</updated>
    <id>http://cxh.me/2015/03/16/linux-install-uninstall-tar-ball</id>
    <content type="html"><![CDATA[<p>  源码安装的一些NOTE:</p>

<ol>
<li>首先./configure &mdash;helps是可以看到所有编译选项的。</li>
<li>centos下，<code>yum install xx.rpm</code>，可以安装依赖，ubuntu下：<code>apt-get build-dep xx</code></li>
<li>zsh下，./configure tab是会提示所有的编译选项的。</li>
<li><p>Makefile如果没有uninstall选项，更合理的办法似乎是：</p>

<ol>
<li><p>先install到一个单独目录：</p>

<p> find . -exec rm 安装目录/{} \;</p></li>
</ol>


<p> 文件夹自然会失败。</p></li>
</ol>

]]></content>
  </entry>
  
</feed>
